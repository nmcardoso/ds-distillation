<html lang="pt">
  <head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/base16/dracula.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/highlightjs-copy@1.0.3/dist/highlightjs-copy.min.css">
    <style>
      pre {
        border-radius: 4px;
      }
    </style>
  </head>

  <body>
    <div class="container my-5">
      <div class="text-center">
        <div class="row justify-content-center">
          <div class="col-12">
            <h2>Titulo do Trabalho</h2>
          </div>
        </div>

        <div class="row justify-content-center mt-4">
          <div class="col-5">
            <h4>Leonardo S. B. <sup>1</sup></h4>
          </div>
          <div class="col-5">
            <h4>Natanael M. Cardoso <sup>1</sup></h4>
          </div>
        </div>

        <div class="row justify-content-center mt-2">
          <div class="col-12">
            <sup>1</sup> Departamento de Eng. da Computação, Escola Politécnica, 
            Universidade de São Paulo
          </div>
        </div>
      </div>
      

      <hr class="my-4" />
      

      <h4>1. Destilação do Conjunto de Dados</h4>
      <p>Para produzir o conjunto de dados destilado, foi realizado o seguinte procedimento:</p>
      
      <ol>
        <li>Criação do ambiente virtual</li>
        <pre><code class="language-bash">cd mtt-distilation</code></pre>
        <pre><code class="language-bash">conda env create -f requirements_11_3.yaml</code></pre>

        <li>Geração das trajetórias</li>
        <pre><code class="language-bash">python buffer.py --dataset=CIFAR100 --model=ConvNet --train_epochs=50 --num_experts=100 --zca --buffer_path={path_to_buffer_storage} --data_path={path_to_dataset}</code></pre>

        <li>Destilação</li>
        <pre><code class="language-bash">python distill.py --dataset=CIFAR100 --ipc=1 --syn_steps=20 --expert_epochs=3 --max_start_epoch=20 --zca --lr_img=1000 --lr_lr=1e-05 --lr_teacher=0.01 --buffer_path={path_to_buffer_storage} --data_path={path_to_dataset}</code></pre>
      </ol>

      <p>A plataforma <b>Weigths & Bias</b> foi utilizada para salvar a 
        telemetria do experimento durante a criação do conjunto de dados destilado. 
        Para acessar o relatório com os dados e artefatos salvos, 
        acesse <a target="_blank" href="https://api.wandb.ai/links/mergernet/xm0hjz10">este link</a>.
      </p>

      <div class="text-center">
        <figure class="figure">
          <img src="https://github.com/nmcardoso/ds-distillation/raw/main/docs/reconstructed_0.png" width="250px" class="figure-img img-fluid rounded">
          <figcaption class="figure-caption">Dataset reconstruído em step=0</figcaption>
        </figure>
        <figure class="figure ms-3">
          <img src="https://github.com/nmcardoso/ds-distillation/raw/main/docs/reconstructed_5000.png" width="250px" class="figure-img img-fluid rounded">
          <figcaption class="figure-caption">Dataset reconstruído em step=5000</figcaption>
        </figure>
        <figure class="figure ms-3">
          <img src="https://github.com/nmcardoso/ds-distillation/raw/main/docs/synthetic_0.png" width="250px" class="figure-img img-fluid rounded">
          <figcaption class="figure-caption">Dataset sintético em step=0</figcaption>
        </figure>
        <figure class="figure ms-3">
          <img src="https://github.com/nmcardoso/ds-distillation/raw/main/docs/synthetic_5000.png" width="250px" class="figure-img img-fluid rounded">
          <figcaption class="figure-caption">Dataset sintético em step=5000</figcaption>
        </figure>
      </div>
      

      <p>
        A tabela a seguir contém os caminhos para aquisição dos arquivos gerados pela destilação do conjunto de dados CIFAR-10.
      </p>

      <table class="table table-striped table-hover">
        <thead>
          <td><b>Step</b></td>
          <td><b>Imagem</b></td>
          <td><b>Imagem ZCA</b></td>
          <td><b>Label</b></td>
        </thead>
        <tbody>
          <tr><td>0</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_0.pt">image_0.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_0.pt">image_zca_0.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_0.pt">labels_0.pt</a></td></tr>
          <tr><td>100</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_100.pt">image_100.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_100.pt">image_zca_100.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_100.pt">labels_100.pt</a></td></tr>
          <tr><td>1000</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_1000.pt">image_1000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_1000.pt">image_zca_1000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_1000.pt">labels_1000.pt</a></td></tr>
          <tr><td>1300</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_1300.pt">image_1300.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_1300.pt">image_zca_1300.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_1300.pt">labels_1300.pt</a></td></tr>
          <tr><td>1600</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_1600.pt">image_1600.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_1600.pt">image_zca_1600.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_1600.pt">labels_1600.pt</a></td></tr>
          <tr><td>1900</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_1900.pt">image_1900.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_1900.pt">image_zca_1900.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_1900.pt">labels_1900.pt</a></td></tr>
          <tr><td>200</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_200.pt">image_200.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_200.pt">image_zca_200.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_200.pt">labels_200.pt</a></td></tr>
          <tr><td>2000</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_2000.pt">image_2000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_2000.pt">image_zca_2000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_2000.pt">labels_2000.pt</a></td></tr>
          <tr><td>2200</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_2200.pt">image_2200.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_2200.pt">image_zca_2200.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_2200.pt">labels_2200.pt</a></td></tr>
          <tr><td>2600</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_2600.pt">image_2600.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_2600.pt">image_zca_2600.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_2600.pt">labels_2600.pt</a></td></tr>
          <tr><td>2900</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_2900.pt">image_2900.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_2900.pt">image_zca_2900.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_2900.pt">labels_2900.pt</a></td></tr>
          <tr><td>300</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_300.pt">image_300.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_300.pt">image_zca_300.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_300.pt">labels_300.pt</a></td></tr>
          <tr><td>3000</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_3000.pt">image_3000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_3000.pt">image_zca_3000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_3000.pt">labels_3000.pt</a></td></tr>
          <tr><td>3100</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_3100.pt">image_3100.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_3100.pt">image_zca_3100.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_3100.pt">labels_3100.pt</a></td></tr>
          <tr><td>3300</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_3300.pt">image_3300.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_3300.pt">image_zca_3300.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_3300.pt">labels_3300.pt</a></td></tr>
          <tr><td>3400</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_3400.pt">image_3400.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_3400.pt">image_zca_3400.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_3400.pt">labels_3400.pt</a></td></tr>
          <tr><td>4000</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_4000.pt">image_4000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_4000.pt">image_zca_4000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_4000.pt">labels_4000.pt</a></td></tr>
          <tr><td>4600</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_4600.pt">image_4600.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_4600.pt">image_zca_4600.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_4600.pt">labels_4600.pt</a></td></tr>
          <tr><td>500</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_500.pt">image_500.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_500.pt">image_zca_500.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_500.pt">labels_500.pt</a></td></tr>
          <tr><td>5000</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_5000.pt">image_5000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_5000.pt">image_zca_5000.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_5000.pt">labels_5000.pt</a></td></tr>
          <tr><td>700</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_700.pt">image_700.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_700.pt">image_zca_700.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_700.pt">labels_700.pt</a></td></tr>
          <tr><td>800</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_800.pt">image_800.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_800.pt">image_zca_800.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_800.pt">labels_800.pt</a></td></tr>
          <tr><td>best</td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_best.pt">image_best.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/image_zca_best.pt">image_zca_best.pt</a></td><td><a href="https://github.com/nmcardoso/ds-distillation/raw/main/outputs/labels_best.pt">labels_best.pt</a></td></tr>
        </tbody>
      </table>

      <p>Para carregar os arquivos, use o seguinte trecho de código:</p>

      <pre><code>import torch
torch.load('image_5000.pt')</code></pre>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy@1.0.3/dist/highlightjs-copy.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
      hljs.addPlugin(new CopyButtonPlugin());
    </script>
  </body>
</html>